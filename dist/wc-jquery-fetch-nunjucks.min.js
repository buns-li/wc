!function(){"use strict";function t(){}function e(t){return function(e){return Object.prototype.toString.call(e)==="[object "+t+"]"}}function i(t,e,i){this.id=t,this.opts=e,this.fac=i,this.state=c.unfetch}function n(t,e){if(p.combo&&(l=t?t.length:0,l)){var n=t.join(",");for(l=t.length;l--;)s[t[l]].state=c.fetching;var o=p.combo.sperator||"??";p.combo.css_root&&h.res.fetch(p.combo.css_root+o+n),p.combo.js_root&&h.res.fetch(p.combo.js_root+o+n).then(function(){for(l=t.length;l--;)e?(i.load(s[t[l]]),u[t[l]]&&delete u[t[l]]):s[t[l]].state=c.fetched})}}var o=["$","http","tpl","util","anim","cache","res"],r=["ready","loaded","scroll","resize"],c={unfetch:0,fetching:1,fetched:2,loaded:3},s={},u={},a={},f={},d={},p={},h={},v={E101:"组件的id不能为空",E102:"此次调用的恢复过程受阻,由于接收不到恢复信号",E103:"注入器没有对应的具体实现,请使用wc.inject()来填充此注入器",W101:"组件对外自定义的注入器不包含在($、http、tpl、util、anim)中",W102:"wc.inject()缺少必备参数",W103:"调用wc.inject()时,如未指定replace=true的条件下,injectKV只能为键值对类型"};t.on=function(e,i,n){var o=this;if(!e||!i)return o;var r=i;if(n){var c=!1,s=i;r=function(){t.off(e,r),c||(c=!0,s.apply(this,arguments))}}for(var u,l=(e=e.split(",")).length;l--;)(u=a[e[l]])&&u.length?u.push(r):a[e[l]]=[r];return this},t.off=function(t,e){var i=this;if(!t&&!e)return i;var n=a[t],o=void 0;if(n&&(o=n.length))if(e)for(;o--;)n[o]===e&&n.splice(o,1);else delete a[t];return i},t.emit=function(t,e){for(var i=void 0,n=void 0,o=t.length,r=0;r<o;r++)if(d.sub_topic_idx=r,(i=a[t[r]])&&i.length)for(n=(i=i.slice()).length;n--;)d.sub__topic_fn_idx=n,i[n].apply(null,e)};var b=e("Object"),g=e("String"),_=Object.assign,m=function(t){return console.warn(t)};[].includes||(Array.prototype.includes=function(t){for(var e=this.length;e--;)if(this[e]===t)return!0;return!1});var w=Array.prototype.slice,y=function(){};Function.prototype.bind=Function.prototype.bind||function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=w.call(arguments,1),i=this,n=function(){return i.apply(this instanceof y?this:t,e.concat(w.call(arguments)))};return this.prototype&&(y.prototype=this.prototype),n.prototype=new y,n};i.nameFn=function(t,e){return t+"_"+e},i.load=function(e){e.fac.call(e),e.state=c.loaded,delete e.fac;var n=f[e.id];if(n){var o=s[n.pub].deps;if(o){var r=o[n.pub];if(r&&r.length&&r.__cb){d.pub=n.pub,d.time=n.time;var u=r[d.sub_idx=idx];t.emit(i.nameFn(e.id,u.join(","+e.id+"_")).split(","),n.data)}}}},i.util={pause:function(){if(d.cmp&&d.pub){var t=s[d.cmp].deps[d.pub];if(t&&t.length&&t.__cb){var e=d.sub_idx,i=t[e].__trace=t[e].__trace||{},n=d.time;return i[n]=i[n]||[],d.cmp+"::"+d.pub+"::"+d.sub_idx+"::"+n+"::"+d.sub_topic_idx+"::"+d.sub_topic_fn_idx}}},resume:function(t,e){if(!e)throw new Error(v.E103);var n=e.split("::"),o=s[n[0]];if(o){var r=o.deps;if(o){var c=r[n[1]];if(c&&c.length&&c.__cb){var u=c[n[2]].__trace[n[3]],l=u[n[4]]=u[n[4]]||[];l[n[5]]=t;var f=r[n[1]][n[2]].topics,d=a[i.nameFn(n[0],real_topic[n[4]])];if(l.length===d&&(l.__fnok=!0),u.length===f.length){for(var p=!0,h=u.length;h--;)if(!("__fnok"in u[h])&&u[h].__fnok){p=!1;break}p&&(c.__cb.apply(null,u),delete c[n[2]].__trace[n[3]])}}}}}},i.prototype={constructor:i,out:function(e,n){return t.on(i.nameFn(this.id,e),n.bind(i.util)),this},host:function(e,n){return r.includes(e)&&t.on(e,n.bind(i.util),"ready"===e||"loaded"===e),this},pub:function(e,n,o){var r=this.deps;if(!e||!r)return this;var u=r[e];if(u.__cb=o,!u||!u.length)return this;d.pub=e,d.cmp=this.id;for(var l=void 0,a=void 0,p=void 0,h=void 0,v=0,b=u.length;v<b;v++)switch(a=u[v],l=s[p=a.id],~a.topics.indexOf(",")?a.topics=a.topics.split(","):g(a.topics)&&(a.topics=[a.topics]),d.sub_idx=v,d.time=(new Date).getTime(),l.state){case c.fetched:i.load(l);case c.loaded:t.emit(i.nameFn(p,a.topics.join(","+p+"_")).split(","),n);break;case c.fetching:case c.unfetch:(h=f[a.id]=f[a.id]||{}).idx=v,h.pub=this.id,h.time=d.time,h.data=n}return this}};var x={};x.cmp=function(t,e,n){if(!t)return m(v.E101);var o=s[t];return o?(o.fac=n,o.opts=_(o.opts,e)):o=s[t]=new i(t,e,n),o.state=c.fetched,this},x.conf=function(t){for(var e,n=o.length;n--;)p[e=o[n]]=!(e in t)||!!t[e];p.util=!0,p.threshold=t.threshold||0;for(var r=void 0,c=o.length;c--;)p[r=o[c]]&&Object.defineProperty(i.prototype,r,{writable:!1,configurable:!1,value:h[r]});c=t.cmps.length;for(var u=void 0,l=void 0,f=void 0;c--;)if(r=t.cmps[c],u=s[r.id],u?u.opts=r.opts?_(u.opts,r.opts):u.opts:u=new i(r.id,r.opts),u.deps=r.deps,r.nested)required.push(u.id);else if(r.ctx)u.ctx=r.ctx;else if(l=r.usage){var d=void 0;for(f=l.length;f--;)if((d=l[f]).nested)required.push(u.id);else if(d.ctx)if(u.ctx)if(u.ctx===d.ctx)d.opts&&(u.opts=_(u.opts,d.opts));else{var v=new i(u.id+d.ctx,d.opts,u.fac);v.ctx=d.ctx,v.deps=d.deps,s[v.id]=v}else u.ctx=d.ctx,d.opts&&(u.opts=_(u.opts,d.opts))}if(p.combo=t.combo,t.debug){var b=x.data={};b.cmps=s,b.topics=a,b.injectors=h}return x},x.inject=function(t,e,i){if(arguments.length<2)return m(v.W102),this;if(i)h[t]=e;else{if(!b(e))return m(v.W103),this;var n=h[t]||(h[t]={}),o="util"===t?n.extend:h.util.extend;if(o)o(n,e);else for(var r in e)n[r]=e}return x},x.pub=function(e,i){return e?(r.includes(e)&&t.emit([e],i),this):this},x.load=function(t){var e=void 0,o=void 0,r=[],l=h.util.isInVisualArea;if(t)for(o=u.length;o--;)l((e=u[o]).ctx,p.threshold)&&r.push(e.id);else for(var a in s)switch((e=s[a]).state){case c.fetched:i.load(e);break;case c.unfetch:l(e.ctx,p.threshold)?r.push(a):u.push(a)}r.length&&n(r,!0)},window.wc=x}(),function(){"use strict";var t=function t(e,i){return new t.fn.ctor(e,i)};(t.fn=t.prototype={ctor:function(t,e){this.url=t,this.opts=e},method:function(t){},get:function(){},post:function(){}}).ctor.prototype=t.fn,wc.inject("http",t,!0)}(),function(){"use strict";function t(t,e,i){var o=void 0,r=void 0,c=void 0,s=null,u=0;i||(i={});var l=function(){u=!1===i.leading?0:n(),s=null,c=t.apply(o,r),s||(o=r=null)};return function(){var a=n();u||!1!==i.leading||(u=a);var f=e-(a-u);return o=this,r=arguments,f<=0||f>e?(s&&(clearTimeout(s),s=null),u=a,c=t.apply(o,r),s||(o=r=null)):s||!1===i.trailing||(s=setTimeout(l,f)),c}}function e(t,e){function i(t,e){var n,o=t.sheet;if(isOldWebKit)o&&(n=!0);else if(o)try{o.cssRules&&(n=!0)}catch(t){"NS_ERROR_DOM_SECURITY_ERR"===t.name&&(n=!0)}setTimeout(function(){n?e&&e():i(t,e)},20)}var n=void 0;"string"==typeof t?(n=t,t={callback:e}):n=t.url;var o=t.charset||"utf-8",r=n&&/\.css(?:\?|$)/i.test(n),c=document.createElement(r?"link":"script");c.charset=isFunction(o)?o():o,t.crossorigin&&(c.crossorigin=t.crossorigin),r?c.rel="stylesheet":(c.async=!0,c.type=t.type||"text/javascript"),function(t,e,n,o){function r(i){t.onload=t.onerror=t.onreadystatechange=null,t=null,e&&e(i)}var c="onload"in t;!o||!isOldWebKit&&c?c?(t.onload=r,t.onerror=function(){r({uri:n,node:t})}):t.onreadystatechange=function(){/loaded|complete/.test(t.readyState)&&r()}:setTimeout(function(){i(t,e)},1)}(c,t.callback,n||"inline-script",r),r?c.href=n:c.src=n,baseElement?head.insertBefore(c,baseElement):head.appendChild(c)}function i(t,e){e=e||0;var i=o(t),n=i.offset(),r=n.left-e,s=n.top-e,u=i.width()+r+e,l=i.height()+s+e,a=c||$(window),f=a.scrollLeft(),d=a.scrollTop(),p=f+a.width(),h=d+a.height();return!(r>p||f>u||s>h||d>l)}var n=Date.now||function(){return(new Date).getTime()},o=window.$;window.$&&delete window.$,window.jQuery&&delete window.jQuery,wc.inject("$",function(t){return t?this.ctx?o(this.ctx).find(t):o(t):o(this.ctx)},!0).inject("util",{extend:o.extend,throttle:t,isInVisualArea:i}).inject("res",{fetch:function(t){var i=o.Deferred();return e(t,function(t,e){return t?i.reject(t):i.resolve("ok")}),i.promise()}},!0);var r=o(document).ready(function(){wc.load(),wc.pub("ready")}),c=o(window).on("scroll",t(function(){return wc.pub("scroll",[c.scrollTop(),c.scrollLeft()])},300)).on("resize",t(function(){return wc.pub("resize",[c.width(),c.height(),r.width(),r.height()])},300)).on("loaded",function(){return wc.pub("loaded")})}(),function(){"use strict";wc.inject("tpl",function(t,e){return nunjucks.render(t,e)},!0)}();